"use strict";(self.webpackChunkalan_turing_ppi=self.webpackChunkalan_turing_ppi||[]).push([[673],{9848:function(e,t,n){n.r(t),n.d(t,{Indicators:function(){return E},default:function(){return Z}});var a=n(4165),l=n(5861),c=n(885),o=n(2791),u=n(9164),i=n(1889),r=n(890),s=n(9373),d=n(8870),m=n(8333),h=n.p+"static/media/template_indicators.0555bad5f0a90d084693.xlsx",p='Please upload the data associated to the development indicators that you wish to analyse. You should download the spreadsheet template and consult the "metadata" tab for an explanation on how each variable should be formatted. The app will run a quality check to make sure that the data are in the correct format. If you do not have data and only wish to experiment with the app, the template provides an "example" tab with synthetic data that you can copy and paste into the "template" tab.',g='Download the spreadsheet template and fit the "template" tab with your data in development indicators.',f=n(429),x=n(5131),v=n(4526),b=n(4045),_=n(415),w=["#4839ba","#2e682c","#d2e0dd","#767ea0","#e23675","#68a892","#272f84","#a58657","#c99e91","#5e3724","#702b53","#845e60","#46b3b5","#1a3135","#000c06","#7c7460","#1ba32d","#369918","#201bb5","#3a2a33","#3e1244","#2d0e1b","#93147a","#938c60","#070507","#443887","#62db8e","#20281d","#0d1601","#404440","#d86f68","#a0c5ef","#3d6345","#141009","#b7ac9a","#20350c","#020102","#f2f9f8","#329e8f","#070203","#f8d6ff","#090f0d","#0fada5","#a5f455","#697019","#01442c","#d6ba40","#42380b","#5dccb0","#6b894d","#772920","#9b413b","#110405","#171456","#556046","#0c0f0f","#bf0f23","#2d3749","#237a4d","#ecfc9c","#0b004f","#4c064a","#0d2954","#186024","#1c1b15","#210630","#5a5b16","#49775a","#542541","#f570f9","#c0dbed","#e067d6","#f4dcee","#01363f","#242326","#f9ab86","#38ced8","#b73e58","#c61199","#77096c","#00db33","#1b443f","#24a58e","#019343","#86baaf","#0b1616","#11110a","#0c1c02","#3e4736","#607063","#cdd6cf","#205908","#77ad2d","#48725c","#020201","#000000","#3b3f1e","#707070","#080a09","#476310","#141613","#bbef62","#d7e2e1","#052d11","#090c08","#5c9155","#587760","#49c629","#27594d","#4cf782","#02230b","#2b3f3d","#444444","#2fc6a8","#a2e840","#97db7d","#2f490e","#13a37a","#c9dbca"],R={sheet:{type:"",dimension:"",value:""},indicator_label:{columnRegex:new RegExp("^A"),columnStart:"A1"},initial_value:{columnRegex:new RegExp("^B"),columnStart:"B1"},final_value:{columnRegex:new RegExp("^C"),columnStart:"C1"},alpha:{columnRegex:new RegExp("^D"),columnStart:"D1"},alpha_prime:{columnRegex:new RegExp("^E"),columnStart:"E1"},beta:{columnRegex:new RegExp("^F"),columnStart:"F1"},success_rates:{columnRegex:new RegExp("^G"),columnStart:"G1"},instrumental:{columnRegex:new RegExp("^H"),columnStart:"H1"},monitoring:{columnRegex:new RegExp("^I"),columnStart:"I1"},rule_of_law:{columnRegex:new RegExp("^J"),columnStart:"J1"},min_value:{columnRegex:new RegExp("^K"),columnStart:"K1"},max_value:{columnRegex:new RegExp("^L"),columnStart:"L1"},indicator_name:{columnRegex:new RegExp("^M"),columnStart:"M1"},indicator_color:{columnRegex:new RegExp("^N"),columnStart:"N1"}},y=function(){var e=(0,l.Z)((0,a.Z)().mark((function e(t,n){var l,c,o,u,i,r,s,d,m,h,p,g,f,x,v,y,S,j,E,Z,k,I,A,C,F,P,q,D,T,Y,z=arguments;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l=z.length>2&&void 0!==z[2]?z[2]:"template",c=!1,o=new Set,u=function(e){if(e>w.length){var t=e-w.length;for(T=w.slice(0,t);t>=0;)T=T.concat(w.slice(0,t)),t-=w.length}else T=w.slice(0,e)},i=function(e,t){return e.length===t.length&&e.every((function(e,n){return e<t[n]}))},r=function(e,t){return e.length===t.length&&e.some((function(e,n){return e===t[n]}))},s=function(e){return"n"===e.t},d=function(e){return e.v>=0},m=function(e){return e.v>=0&&e.v<=1},h=function(e){return 0===e.v||1===e.v},p=function(e){return/^#[0-9A-F]{6}$/i.test(e.v)},g=function(e,t,n){"type"===n?o.add("All values should be numeric - ".concat(e," ").concat(t)):"dimension"===n?o.add("The number of values should be the same as the number of values in column ".concat(e)):"R"===n?o.add("At least one value must be > 0"):"value"===n?o.add("Each value should not contain more than 12 characters - ".concat(t)):"unique"===n?o.add("".concat(e," should all be unique values")):"empty"===n?o.add("The uploaded file structure does not meet the template format or is empty - ".concat(e)):"wrong_sheet"===n?o.add("The file uploaded do not contain a sheet with the name: ".concat(l," ")):"success_rates"===n?o.add("You must have values in alpha, alpha_prime and beta if ".concat(e," is empty")):"color"===n?o.add("Color values must be proper hex values"):"higher"===n?o.add("".concat(e," has a higher value than ").concat(t)):"lower"===n?o.add("".concat(e," has a lower value than ").concat(t)):"identical"===n?o.add("Values of ".concat(e," cannot be the same as ").concat(t)):o.add("All values should be between 0 and 1 - ".concat(e)),c=!0},"xlsx"===t||"xls"===t){e.next=16;break}throw new Error("Wrong format file");case 16:return e.next=18,(0,_.y3)(n);case 18:f=e.sent,x=b.ij(f,{type:"base64"}),v=[],y=[],S=[],j=[],E=[],Z=[],k=[],I=[],A=[],C=[],F=[],P=[],q=[],D=[],T=[],(Y=x.Sheets[l])&&0!==Y.length?(Object.keys(Y).map((function(e){R.indicator_label.columnRegex.test(e)&&e!==R.indicator_label.columnStart&&("s"===Y[e].t?Y[e].v.length>12?g("indicator_label",e,"value"):q.push(Y[e].v):g("indicator_label",e,"type")),R.initial_value.columnRegex.test(e)&&e!==R.initial_value.columnStart&&(s(Y[e])&&d(Y[e])?v.push(Y[e].v):g("initial_value",e,"type")),R.final_value.columnRegex.test(e)&&e!==R.final_value.columnStart&&(s(Y[e])&&d(Y[e])?y.push(Y[e].v):g("final_value",e,"type")),R.alpha.columnRegex.test(e)&&e!==R.alpha.columnStart&&(s(Y[e])&&d(Y[e])?S.push(Y[e].v):g("alpha",e,"type")),R.alpha_prime.columnRegex.test(e)&&e!==R.alpha_prime.columnStart&&(s(Y[e])&&d(Y[e])?j.push(Y[e].v):g("alpha_prime",e,"type")),R.beta.columnRegex.test(e)&&e!==R.beta.columnStart&&(s(Y[e])&&d(Y[e])?E.push(Y[e].v):g("beta",e,"type")),R.success_rates.columnRegex.test(e)&&e!==R.success_rates.columnStart&&(s(Y[e])&&m(Y[e])?Z.push(Y[e].v):g("success_rates",e,"type")),R.instrumental.columnRegex.test(e)&&e!==R.instrumental.columnStart&&(s(Y[e])&&h(Y[e])?k.push(Y[e].v):g("instrumental",e,"type")),R.monitoring.columnRegex.test(e)&&e!==R.monitoring.columnStart&&(s(Y[e])&&m(Y[e])?I.push(Y[e].v):g("monitoring",e,"type")),R.rule_of_law.columnRegex.test(e)&&e!==R.rule_of_law.columnStart&&(s(Y[e])&&m(Y[e])?A.push(Y[e].v):g("rule_of_law",e,"type")),R.min_value.columnRegex.test(e)&&e!==R.min_value.columnStart&&(s(Y[e])&&d(Y[e])?F.push(Y[e].v):g("min_value",e,"type")),R.max_value.columnRegex.test(e)&&e!==R.max_value.columnStart&&(s(Y[e])&&d(Y[e])?C.push(Y[e].v):g("max_value",e,"type")),R.indicator_name.columnRegex.test(e)&&e!==R.indicator_name.columnStart&&D.push(Y[e].v),R.indicator_color.columnRegex.test(e)&&e!==R.indicator_color.columnStart&&(p(Y[e])?T.push(Y[e].v):g("color",e,"color"))})),0===q.length&&g("indicator_label",null,"empty"),new Set(q).size!==q.length&&g("indicator_label",null,"unique"),0===v.length?g("initial_value",null,"empty"):(v.length!==I.length&&0!==I.length&&g("monitoring",null,"dimension"),Z.length||S.length&&j.length&&E.length||g("success_rates",null,"success_rates"),v.length!==S.length&&S.length>0&&g("alpha",null,"dimension"),v.length!==j.length&&j.length>0&&g("alpha_prime",null,"dimension"),v.length!==E.length&&E.length>0&&g("beta",null,"dimension"),v.length!==k.length&&g("instrumental",null,"dimension"),v.length!==A.length&&0!==A.length&&g("rule_of_law",null,"dimension"),v.length!==C.length&&C.length>0&&g("max_value",null,"dimension"),v.length!==F.length&&F.length>0&&g("min_value",null,"dimension"),!i(F,v)&&F.length>0&&g("min_value","initial_value","higher"),!i(F,y)&&F.length>0&&g("min_value","final_value","higher"),i(v,C)||g("max_value","initial_value","lower"),i(y,C)||g("max_value","final_value","lower"),r(v,y)&&g("initial_value","final_value","identical")),nj.sum(k)>0||g("instrumental",null,"zero")):g("sheet",null,"wrong_sheet");case 37:if(c){e.next=44;break}return 0===T.length&&u(v.length),0===I.length&&(I=Array.from({length:v.length},(function(){return.5}))),0===A.length&&(A=Array.from({length:v.length},(function(){return.5}))),e.abrupt("return",{I0:v,IF:y,alpha:S,alpha_prime:j,beta:E,success_rates:Z,R:k,qm:I,rl:A,Imax:C,Imin:F,G:P,ID:q,color:T,name:D});case 44:return e.abrupt("return",{error:!0,errors:o});case 45:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),S=n(8579),j=n(184),E=function(e){var t=e.nextStep,n=e.indicatorsFile,b=e.setIndicatorsFile,w=e.simulationState,R=e.setIndicatorsResult,E=o.useState(!1),Z=(0,c.Z)(E,2),k=Z[0],I=Z[1],A=o.useState(null),C=(0,c.Z)(A,2),F=C[0],P=C[1],q=function(){var e=(0,l.Z)((0,a.Z)().mark((function e(t){var n,l;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t||!t.name){e.next=9;break}return n=(0,_.fB)(t),e.next=4,y(n,t);case 4:l=e.sent,b(t),l.error?(I(!1),P(l)):(I(!0),P(l),R(l)),e.next=12;break;case 9:b([]),I(!1),P(null);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return o.useEffect((function(){var e=document.createElement("script");return e.src="/numjs.min.js",e.async=!0,document.body.appendChild(e),function(){document.body.removeChild(e)}}),[]),(0,j.jsx)(u.Z,{maxWidth:"xl",sx:{paddingY:function(e){return[e.spacing(4),e.spacing(4),e.spacing(8)]}},children:(0,j.jsxs)(i.ZP,{container:!0,rowSpacing:4,columnSpacing:8,columnns:{xs:4,sm:8,md:12,lg:12},children:[(0,j.jsx)(i.ZP,{item:!0,xs:12,md:5,children:(0,j.jsx)(S.J,{})}),(0,j.jsx)(i.ZP,{item:!0,xs:12,md:7,children:(0,j.jsx)(f.Y,{selected:w})}),(0,j.jsxs)(i.ZP,{item:!0,xs:12,md:5,children:[(0,j.jsx)(r.Z,{variant:"h1",children:"Indicators"}),(0,j.jsx)(r.Z,{variant:"body1",mt:4,children:p}),(0,j.jsx)(r.Z,{variant:"body1",mt:4,mb:2,children:g}),(0,j.jsx)(s.Z,{variant:"outlined",href:h,children:"Download template"})]}),(0,j.jsxs)(i.ZP,{item:!0,xs:12,md:7,children:[(0,j.jsx)(x.Q,{maxFiles:1,previewsPerLine:1,supportedExtensions:["xlsx","xls"],onFileSelection:function(e){q(e?e[0]:[])}}),n&&F&&n.name&&(0,j.jsx)(v.f,{component:"indicator",verified:k,validationResult:F}),(0,j.jsx)(d.Z,{mt:4,textAlign:"right",children:(0,j.jsx)(s.Z,{variant:"contained",size:"large",onClick:function(){return t()},disabled:!k,endIcon:(0,j.jsx)(m.Z,{}),children:"Next"})})]})]})})},Z=E}}]);
//# sourceMappingURL=673.c0a0855c.chunk.js.map